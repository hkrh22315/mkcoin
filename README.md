# GMOコイン BTC/JPY自動売買プログラム

GMOコインのAPIを使用して、BTC/JPYの自動売買を行うPythonプログラムです。

## 機能

- 移動平均線クロス戦略による自動売買
- リスク管理機能（損切り、利確、ポジションサイズ管理、反転注文数上限、エラー連続時の自動停止）
- 手動実行モード（初期実装）
- 取引履歴の記録とログ機能

## セットアップ

1. 依存パッケージのインストール
```bash
pip install -r requirements.txt
```

2. 環境変数の設定
`.env.example`を`.env`にコピーし、GMOコインのAPIキーとシークレットキーを設定してください。
```bash
cp .env.example .env
# .envファイルを編集してAPIキーとシークレットキーを設定
```

3. 設定ファイルの編集
`config/config.yaml`を編集して、取引設定とリスク管理設定を調整してください。

## 使用方法

### 手動実行モード
```bash
python src/main.py
```

実行すると以下の処理が行われます：
1. 取引所ステータスの確認
2. 既存ポジションの損切り・利確チェック
3. 移動平均線によるシグナル検出
4. シグナルに基づく注文発注
5. 資産残高の表示

## 設定項目

詳細は`config/config.yaml`を参照してください。

### API設定
- APIキー、シークレットキー（環境変数から読み込み）

### 取引設定
- 通貨ペア（デフォルト: BTC_JPY）
- 注文タイプ（MARKET: 成行、LIMIT: 指値）
- 取引数量（BTC単位）
- 移動平均線の短期期間（デフォルト: 20）
- 移動平均線の長期期間（デフォルト: 50）
- ローソク足の時間足（1min, 5min, 15min, 1hourなど）

### リスク管理設定
- 損切り額（円）
- 利確額（円）
- 最大ポジションサイズ（BTC単位）
- 反転注文数の上限（回数）
- エラー連続許容回数（回数）

## ファイル構成

```
mkcoin/
├── README.md                 # プロジェクト説明
├── requirements.txt          # Python依存パッケージ
├── .env.example              # 環境変数テンプレート
├── config/
│   └── config.yaml          # 設定ファイル
├── src/
│   ├── __init__.py
│   ├── api/
│   │   ├── __init__.py
│   │   └── gmo_client.py    # GMOコインAPIクライアント
│   ├── strategy/
│   │   ├── __init__.py
│   │   └── moving_average.py # 移動平均線戦略
│   ├── risk/
│   │   ├── __init__.py
│   │   └── risk_manager.py  # リスク管理
│   ├── utils/
│   │   ├── __init__.py
│   │   ├── logger.py        # ログ機能
│   │   └── config_loader.py # 設定読み込み
│   └── main.py              # メイン実行ファイル
├── logs/                     # ログファイル格納
└── data/                     # 取引履歴データ格納
```

## 注意事項

- 本プログラムは自動売買を行うため、十分なテストを行ってから実際の資金で運用してください
- APIキーとシークレットキーは絶対に公開しないでください
- 取引にはリスクが伴います。自己責任でご利用ください
- 本プログラムは手動実行モードのみ実装されています。自動実行モードは将来の実装予定です

## トラブルシューティング

### APIキーエラー
- `.env`ファイルに正しくAPIキーとシークレットキーが設定されているか確認してください
- GMOコインの会員ページでAPIキーが有効になっているか確認してください

### KLineデータが取得できない
- 指定した時間足と日付の組み合わせが正しいか確認してください
- 取引所が開いている時間帯で実行してください

### 注文が発注できない
- 取引余力が十分にあるか確認してください
- 注文数量が最小注文単位を満たしているか確認してください

## 参考情報

- GMOコインAPIドキュメント: https://api.coin.z.com/docs/
- 最低取引単位: 0.00001 BTC
- 取引手数料: Maker -0.01%, Taker 0.05%
